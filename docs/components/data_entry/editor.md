# ÂØåÊñáÊú¨ÁºñËæëÂô®

## Âü∫Á°ÄÁ§∫‰æã

### ÂåÖÂê´‰∏ä‰º†ÂõæÁâáÁöÑÁºñËæëÂô®

```jsx
import React, { useState } from "react";
import { Editor } from "zs_library";

export default () => {
  const [value, setValue] = useState({
    type: "doc",
    content: [
      {
        type: "heading",
        attrs: { level: 2 },
        content: [{ type: "text", text: "Introducing Novel" }],
      },
    ],
  });

  console.log("üöÄ ~ value:", value);

  return (
    <div>
      <Editor
        initialContent={value}
        onChange={setValue}
        uploadImageProps={{
          action: "https://tmpfiles.org/api/v1/upload",
          onSuccess: (res) => {
            return res.data.url.replace("tmpfiles.org/", "tmpfiles.org/dl/");
          },
        }}
      />
    </div>
  );
};
```

### ‰ΩøÁî®Ëá™ÂÆö‰πâ‰∏ä‰º†ÂáΩÊï∞

ÂΩìÈúÄË¶ÅÊõ¥Â§çÊùÇÁöÑ‰∏ä‰º†ÈÄªËæëÊó∂ÔºåÂèØ‰ª•‰ΩøÁî® `customUploadFn` Êù•ÂÆåÂÖ®ÊéßÂà∂‰∏ä‰º†ËøáÁ®ãÔºö

```jsx
import React, { useState } from "react";
import { Editor } from "zs_library";

export default () => {
  const [value, setValue] = useState({
    type: "doc",
    content: [
      {
        type: "heading",
        attrs: { level: 2 },
        content: [{ type: "text", text: "Ëá™ÂÆö‰πâ‰∏ä‰º†Á§∫‰æã" }],
      },
    ],
  });
  // Ëá™ÂÆö‰πâ‰∏ä‰º†ÂáΩÊï∞
  const customUpload = async (file) => {
    try {
      // 1. ÊûÑÂª∫Ë°®ÂçïÊï∞ÊçÆ
      const formData = new FormData();
      formData.append("file", file);

      // 2. ÂèëÈÄÅËØ∑Ê±ÇÂà∞ tmpfiles.org API
      const response = await fetch("https://tmpfiles.org/api/v1/upload", {
        method: "POST",
        body: formData,
      });

      if (!response.ok) {
        throw new Error(`‰∏ä‰º†Â§±Ë¥•: ${response.status}`);
      }

      const result = await response.json();

      // 3. ËøîÂõûÁªìÊûúÔºåÊîØÊåÅÂ§öÁßçÊ†ºÂºè
      return result; // ‰æãÂ¶Ç: { data: { url: "https://tmpfiles.org/...", ... } }
    } catch (error) {
      console.error("‰∏ä‰º†Â§±Ë¥•:", error);
      throw error; // ÈáçÊñ∞ÊäõÂá∫ÈîôËØØÔºåËß¶Âèë onError ÂõûË∞É
    }
  };

  return (
    <div>
      <Editor
        initialContent={value}
        onChange={setValue}
        uploadImageProps={{
          // ‰ΩøÁî®Ëá™ÂÆö‰πâ‰∏ä‰º†ÂáΩÊï∞
          customUploadFn: customUpload, // ÊàêÂäüÂõûË∞É‰ºöÊé•Êî∂ customUploadFn ËøîÂõûÁöÑÊï∞ÊçÆ
          onSuccess: (result) => {
            console.log("‰∏ä‰º†ÊàêÂäü:", result);
            // tmpfiles.org ËøîÂõûÊ†ºÂºè: { data: { url: "https://tmpfiles.org/..." } }
            // ÈúÄË¶ÅÂ§ÑÁêÜ URL Ê†ºÂºè‰ª•‰æøÁõ¥Êé•ËÆøÈóÆ
            return result.data.url.replace("tmpfiles.org/", "tmpfiles.org/dl/");
          },
          // ÈîôËØØÂõûË∞É
          onError: (error) => {
            console.error("‰∏ä‰º†Â§±Ë¥•:", error);
            alert(`ÂõæÁâá‰∏ä‰º†Â§±Ë¥•: ${error.message}`);
          },
          // ‰∏ä‰º†ÂâçÈ™åËØÅ
          beforeUpload: (file) => {
            // Ê£ÄÊü•Êñá‰ª∂Á±ªÂûã
            if (!file.type.startsWith("image/")) {
              alert("Âè™ËÉΩ‰∏ä‰º†ÂõæÁâáÊñá‰ª∂");
              return false;
            }
            // Ê£ÄÊü•Êñá‰ª∂Â§ßÂ∞èÔºà5MBÔºâ
            if (file.size > 5 * 1024 * 1024) {
              alert("ÂõæÁâáÂ§ßÂ∞è‰∏çËÉΩË∂ÖËøá 5MB");
              return false;
            }
            return true;
          },
        }}
      />
    </div>
  );
};
```

### Ê∏≤Êüì Json ‰∏∫ Html

```jsx
import { Editor } from "zs_library";

export default () => {
  return (
    <Editor.Preview
      json={{
        type: "doc",
        content: [
          {
            type: "heading",
            attrs: { level: 2 },
            content: [{ type: "text", text: "Introducing Novel" }],
          },
          {
            type: "paragraph",
            content: [
              {
                type: "text",
                marks: [
                  {
                    type: "link",
                    attrs: {
                      href: "https://github.com/steven-tey/novel",
                      target: "_blank",
                    },
                  },
                ],
                text: "Novel",
              },
              {
                type: "text",
                text: " is a Notion-style WYSIWYG editor with AI-powered autocompletion. Built with ",
              },
              {
                type: "text",
                marks: [
                  {
                    type: "link",
                    attrs: {
                      href: "https://tiptap.dev/",
                      target: "_blank",
                    },
                  },
                ],
                text: "Tiptap",
              },
              { type: "text", text: " + " },
              {
                type: "text",
                marks: [
                  {
                    type: "link",
                    attrs: {
                      href: "https://sdk.vercel.ai/docs",
                      target: "_blank",
                    },
                  },
                ],
                text: "Vercel AI SDK",
              },
              { type: "text", text: "." },
            ],
          },
          {
            type: "heading",
            attrs: { level: 3 },
            content: [{ type: "text", text: "Installation" }],
          },
          {
            type: "codeBlock",
            attrs: { language: null },
            content: [{ type: "text", text: "npm i novel" }],
          },
          {
            type: "heading",
            attrs: { level: 3 },
            content: [{ type: "text", text: "Usage" }],
          },
          {
            type: "codeBlock",
            attrs: { language: null },
            content: [
              {
                type: "text",
                text: 'import { Editor } from "novel";\n\nexport default function App() {\n  return (\n     <Editor />\n  )\n}',
              },
            ],
          },
          {
            type: "heading",
            attrs: { level: 3 },
            content: [{ type: "text", text: "Features" }],
          },
          {
            type: "orderedList",
            attrs: { tight: true, start: 1 },
            content: [
              {
                type: "listItem",
                content: [
                  {
                    type: "paragraph",
                    content: [
                      { type: "text", text: "Slash menu & bubble menu" },
                    ],
                  },
                ],
              },
              {
                type: "listItem",
                content: [
                  {
                    type: "paragraph",
                    content: [
                      { type: "text", text: "AI autocomplete (type " },
                      { type: "text", marks: [{ type: "code" }], text: "++" },
                      {
                        type: "text",
                        text: " to activate, or select from slash menu)",
                      },
                    ],
                  },
                ],
              },
              {
                type: "listItem",
                content: [
                  {
                    type: "paragraph",
                    content: [
                      {
                        type: "text",
                        text: "Image uploads (drag & drop / copy & paste, or select from slash menu) ",
                      },
                    ],
                  },
                ],
              },
              {
                type: "listItem",
                content: [
                  {
                    type: "paragraph",
                    content: [
                      {
                        type: "text",
                        text: "Add tweets from the command slash menu:",
                      },
                    ],
                  },
                ],
              },
              {
                type: "listItem",
                content: [
                  {
                    type: "paragraph",
                    content: [
                      {
                        type: "text",
                        text: "Mathematical symbols with LaTeX expression:",
                      },
                    ],
                  },
                  {
                    type: "orderedList",
                    attrs: {
                      tight: true,
                      start: 1,
                    },
                    content: [
                      {
                        type: "listItem",
                        content: [
                          {
                            type: "paragraph",
                            content: [
                              {
                                type: "math",
                                attrs: {
                                  latex: "E = mc^2",
                                },
                              },
                            ],
                          },
                        ],
                      },
                      {
                        type: "listItem",
                        content: [
                          {
                            type: "paragraph",
                            content: [
                              {
                                type: "math",
                                attrs: {
                                  latex: "a^2 = \\sqrt{b^2 + c^2}",
                                },
                              },
                            ],
                          },
                        ],
                      },
                      {
                        type: "listItem",
                        content: [
                          {
                            type: "paragraph",
                            content: [
                              {
                                type: "math",
                                attrs: {
                                  latex:
                                    "\\hat{f} (\\xi)=\\int_{-\\infty}^{\\infty}f(x)e^{-2\\pi ix\\xi}dx",
                                },
                              },
                            ],
                          },
                        ],
                      },
                      {
                        type: "listItem",
                        content: [
                          {
                            type: "paragraph",
                            content: [
                              {
                                type: "math",
                                attrs: {
                                  latex:
                                    "A=\\begin{bmatrix}a&b\\\\c&d \\end{bmatrix}",
                                },
                              },
                            ],
                          },
                        ],
                      },
                      {
                        type: "listItem",
                        content: [
                          {
                            type: "paragraph",
                            content: [
                              {
                                type: "math",
                                attrs: {
                                  latex: "\\sum_{i=0}^n x_i",
                                },
                              },
                            ],
                          },
                        ],
                      },
                    ],
                  },
                ],
              },
            ],
          },
          {
            type: "image",
            attrs: {
              src: "https://public.blob.vercel-storage.com/pJrjXbdONOnAeZAZ/banner-2wQk82qTwyVgvlhTW21GIkWgqPGD2C.png",
              alt: "banner.png",
              title: "banner.png",
              width: null,
              height: null,
            },
          },
          { type: "horizontalRule" },
          {
            type: "heading",
            attrs: { level: 3 },
            content: [{ type: "text", text: "Learn more" }],
          },
          {
            type: "taskList",
            content: [
              {
                type: "taskItem",
                attrs: { checked: false },
                content: [
                  {
                    type: "paragraph",
                    content: [
                      { type: "text", text: "Star us on " },
                      {
                        type: "text",
                        marks: [
                          {
                            type: "link",
                            attrs: {
                              href: "https://github.com/steven-tey/novel",
                              target: "_blank",
                            },
                          },
                        ],
                        text: "GitHub",
                      },
                    ],
                  },
                ],
              },
              {
                type: "taskItem",
                attrs: { checked: false },
                content: [
                  {
                    type: "paragraph",
                    content: [
                      { type: "text", text: "Install the " },
                      {
                        type: "text",
                        marks: [
                          {
                            type: "link",
                            attrs: {
                              href: "https://www.npmjs.com/package/novel",
                              target: "_blank",
                            },
                          },
                        ],
                        text: "NPM package",
                      },
                    ],
                  },
                ],
              },
              {
                type: "taskItem",
                attrs: { checked: false },
                content: [
                  {
                    type: "paragraph",
                    content: [
                      {
                        type: "text",
                        marks: [
                          {
                            type: "link",
                            attrs: {
                              href: "https://vercel.com/templates/next.js/novel",
                              target: "_blank",
                            },
                          },
                        ],
                        text: "Deploy your own",
                      },
                      { type: "text", text: " to Vercel" },
                    ],
                  },
                ],
              },
            ],
          },
        ],
      }}
    />
  );
};
```

## API ÂèÇËÄÉ

### Editor Props

| ÂèÇÊï∞               | Á±ªÂûã                             | ËØ¥Êòé           | ÈªòËÆ§ÂÄº  |
| ------------------ | -------------------------------- | -------------- | ------- |
| `initialContent`   | `JSONContent`                    | ÁºñËæëÂô®ÂàùÂßãÂÜÖÂÆπ | -       |
| `onChange`         | `(content: JSONContent) => void` | ÂÜÖÂÆπÂèòÂåñÂõûË∞É   | -       |
| `uploadImageProps` | `UploadImageProps`               | ÂõæÁâá‰∏ä‰º†ÈÖçÁΩÆ   | -       |
| `className`        | `string`                         | Ëá™ÂÆö‰πâÊ†∑ÂºèÁ±ªÂêç | -       |
| `cacheKey`         | `string`                         | ÁºìÂ≠òÈîÆÂêç       | -       |
| `enableCache`      | `boolean`                        | ÊòØÂê¶ÂêØÁî®ÁºìÂ≠ò   | `false` |

### UploadImageProps

| ÂèÇÊï∞             | Á±ªÂûã                           | ËØ¥Êòé                           | ÈªòËÆ§ÂÄº   |
| ---------------- | ------------------------------ | ------------------------------ | -------- |
| `action`         | `string`                       | ‰∏ä‰º†Âú∞ÂùÄÔºà‰ΩøÁî®ÈªòËÆ§‰∏ä‰º†Êó∂ÂøÖÈúÄÔºâ | -        |
| `method`         | `string`                       | ‰∏ä‰º†ÊñπÊ≥ï                       | `'POST'` |
| `name`           | `string`                       | Êñá‰ª∂Â≠óÊÆµÂêç                     | `'file'` |
| `headers`        | `Record<string, string>`       | ËØ∑Ê±ÇÂ§¥                         | -        |
| `maxSize`        | `number`                       | ÊúÄÂ§ßÊñá‰ª∂Â§ßÂ∞è(MB)               | -        |
| `beforeUpload`   | `(file: File) => boolean`      | ‰∏ä‰º†ÂâçÈ™åËØÅÂáΩÊï∞                 | -        |
| `onSuccess`      | `(res: any) => string`         | ‰∏ä‰º†ÊàêÂäüÂõûË∞ÉÔºåËøîÂõûÂõæÁâá URL     | -        |
| `onError`        | `(error: Error) => void`       | ‰∏ä‰º†Â§±Ë¥•ÂõûË∞É                   | -        |
| `customUploadFn` | `(file: File) => Promise<any>` | Ëá™ÂÆö‰πâ‰∏ä‰º†ÂáΩÊï∞                 | -        |

### Ëá™ÂÆö‰πâ‰∏ä‰º†ÂáΩÊï∞ËØ¥Êòé

- `customUploadFn` Êé•Êî∂‰∏Ä‰∏™ `File` ÂèÇÊï∞ÔºåÈúÄË¶ÅËøîÂõû `Promise`
- ËøîÂõûÁöÑÊï∞ÊçÆÊ†ºÂºèÊîØÊåÅÔºö
  - ÂåÖÂê´ `url` Â≠óÊÆµÁöÑÂØπË±°ÔºàÊé®ËçêÔºâ
  - ÂåÖÂê´ÂµåÂ•ó `data.url` ÁªìÊûÑÁöÑÂØπË±°ÔºàÂ¶Ç tmpfiles.org Ê†ºÂºèÔºâ
  - Áõ¥Êé•ÁöÑ URL Â≠óÁ¨¶‰∏≤
  - ÂÖ∂‰ªñÊ†ºÂºèÈúÄË¶ÅÈÄöËøá `onSuccess` ÂõûË∞ÉÂ§ÑÁêÜ
- ÈîôËØØÂ§ÑÁêÜÔºöÊäõÂá∫ÈîôËØØ‰ºöËß¶Âèë `onError` ÂõûË∞É
- `onSuccess` Âíå `onError` ÂõûË∞ÉÁöÑË°å‰∏∫‰∏éÈªòËÆ§‰∏ä‰º†ÊñπÂºèÂÆåÂÖ®‰∏ÄËá¥
- Â¶ÇÊûúÂêåÊó∂Êèê‰æõ‰∫Ü `customUploadFn` Âíå `action`Ôºå‰ºòÂÖà‰ΩøÁî® `customUploadFn`
